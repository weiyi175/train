2025-09-16 18:22:13.602537: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-09-16 18:22:13.870754: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-09-16 18:22:14.757012: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-09-16 18:22:15.651161: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 18:22:15.789086: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 18:22:15.789196: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 18:22:15.792020: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 18:22:15.792092: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 18:22:15.792115: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 18:22:15.908415: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 18:22:15.908542: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 18:22:15.908565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1726] Could not identify NUMA node of platform GPU id 0, defaulting to 0.  Your kernel may not have been built with NUMA support.
2025-09-16 18:22:15.908597: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 18:22:15.908645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9517 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 SUPER, pci bus id: 0000:01:00.0, compute capability: 8.9
GPU detected: 1 physical, 1 logical -> ['/device:GPU:0']
Loaded (1276, 36, 75) (1276,)
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 input (InputLayer)          [(None, 36, 75)]             0         []                            
                                                                                                  
 conv1d (Conv1D)             (None, 36, 64)               4864      ['input[0][0]']               
                                                                                                  
 conv1d_1 (Conv1D)           (None, 36, 64)               12352     ['conv1d[0][0]']              
                                                                                                  
 activation (Activation)     (None, 36, 64)               0         ['conv1d_1[0][0]']            
                                                                                                  
 dropout (Dropout)           (None, 36, 64)               0         ['activation[0][0]']          
                                                                                                  
 conv1d_2 (Conv1D)           (None, 36, 64)               12352     ['dropout[0][0]']             
                                                                                                  
 activation_1 (Activation)   (None, 36, 64)               0         ['conv1d_2[0][0]']            
                                                                                                  
 dropout_1 (Dropout)         (None, 36, 64)               0         ['activation_1[0][0]']        
                                                                                                  
 lambda (Lambda)             (None, 36, 64)               0         ['dropout_1[0][0]']           
                                                                                                  
 add (Add)                   (None, 36, 64)               0         ['conv1d[0][0]',              
                                                                     'lambda[0][0]']              
                                                                                                  
 layer_normalization (Layer  (None, 36, 64)               128       ['add[0][0]']                 
 Normalization)                                                                                   
                                                                                                  
 conv1d_3 (Conv1D)           (None, 36, 64)               12352     ['layer_normalization[0][0]'] 
                                                                                                  
 activation_2 (Activation)   (None, 36, 64)               0         ['conv1d_3[0][0]']            
                                                                                                  
 dropout_2 (Dropout)         (None, 36, 64)               0         ['activation_2[0][0]']        
                                                                                                  
 conv1d_4 (Conv1D)           (None, 36, 64)               12352     ['dropout_2[0][0]']           
                                                                                                  
 activation_3 (Activation)   (None, 36, 64)               0         ['conv1d_4[0][0]']            
                                                                                                  
 dropout_3 (Dropout)         (None, 36, 64)               0         ['activation_3[0][0]']        
                                                                                                  
 lambda_1 (Lambda)           (None, 36, 64)               0         ['dropout_3[0][0]']           
                                                                                                  
 add_1 (Add)                 (None, 36, 64)               0         ['layer_normalization[0][0]', 
                                                                     'lambda_1[0][0]']            
                                                                                                  
 layer_normalization_1 (Lay  (None, 36, 64)               128       ['add_1[0][0]']               
 erNormalization)                                                                                 
                                                                                                  
 conv1d_5 (Conv1D)           (None, 36, 64)               12352     ['layer_normalization_1[0][0]'
                                                                    ]                             
                                                                                                  
 activation_4 (Activation)   (None, 36, 64)               0         ['conv1d_5[0][0]']            
                                                                                                  
 dropout_4 (Dropout)         (None, 36, 64)               0         ['activation_4[0][0]']        
                                                                                                  
 conv1d_6 (Conv1D)           (None, 36, 64)               12352     ['dropout_4[0][0]']           
                                                                                                  
 activation_5 (Activation)   (None, 36, 64)               0         ['conv1d_6[0][0]']            
                                                                                                  
 dropout_5 (Dropout)         (None, 36, 64)               0         ['activation_5[0][0]']        
                                                                                                  
 lambda_2 (Lambda)           (None, 36, 64)               0         ['dropout_5[0][0]']           
                                                                                                  
 add_2 (Add)                 (None, 36, 64)               0         ['layer_normalization_1[0][0]'
                                                                    , 'lambda_2[0][0]']           
                                                                                                  
 layer_normalization_2 (Lay  (None, 36, 64)               128       ['add_2[0][0]']               
 erNormalization)                                                                                 
                                                                                                  
 conv1d_7 (Conv1D)           (None, 36, 64)               12352     ['layer_normalization_2[0][0]'
                                                                    ]                             
                                                                                                  
 activation_6 (Activation)   (None, 36, 64)               0         ['conv1d_7[0][0]']            
                                                                                                  
 dropout_6 (Dropout)         (None, 36, 64)               0         ['activation_6[0][0]']        
                                                                                                  
 conv1d_8 (Conv1D)           (None, 36, 64)               12352     ['dropout_6[0][0]']           
                                                                                                  
 activation_7 (Activation)   (None, 36, 64)               0         ['conv1d_8[0][0]']            
                                                                                                  
 dropout_7 (Dropout)         (None, 36, 64)               0         ['activation_7[0][0]']        
                                                                                                  
 lambda_3 (Lambda)           (None, 36, 64)               0         ['dropout_7[0][0]']           
                                                                                                  
 add_3 (Add)                 (None, 36, 64)               0         ['layer_normalization_2[0][0]'
                                                                    , 'lambda_3[0][0]']           
                                                                                                  
 layer_normalization_3 (Lay  (None, 36, 64)               128       ['add_3[0][0]']               
 erNormalization)                                                                                 
                                                                                                  
 gated_attn_g_channel (_Cha  (None, 36, 64)               64        ['layer_normalization_3[0][0]'
 nnelVectorGateLayer)                                               ]                             
                                                                                                  
 gated_attn_gated_part (Lam  (None, 36, 64)               0         ['layer_normalization_3[0][0]'
 bda)                                                               , 'gated_attn_g_channel[0][0]'
                                                                    ]                             
                                                                                                  
 gated_attn_residual_out (L  (None, 36, 64)               0         ['layer_normalization_3[0][0]'
 ambda)                                                             , 'gated_attn_gated_part[0][0]
                                                                    ']                            
                                                                                                  
 gated_attn_h_from_residual  (None, 36, 32)               2080      ['gated_attn_residual_out[0][0
  (Dense)                                                           ]']                           
                                                                                                  
 gated_attn_score (Dense)    (None, 36, 1)                33        ['gated_attn_h_from_residual[0
                                                                    ][0]']                        
                                                                                                  
 gated_attn_squeeze (Lambda  (None, 36)                   0         ['gated_attn_score[0][0]']    
 )                                                                                                
                                                                                                  
 gated_attn_softmax (Lambda  (None, 36)                   0         ['gated_attn_squeeze[0][0]']  
 )                                                                                                
                                                                                                  
 gated_attn_expand (Lambda)  (None, 36, 1)                0         ['gated_attn_softmax[0][0]']  
                                                                                                  
 gated_attn_weighted (Lambd  (None, 64)                   0         ['layer_normalization_3[0][0]'
 a)                                                                 , 'gated_attn_expand[0][0]']  
                                                                                                  
 out (Dense)                 (None, 1)                    65        ['gated_attn_weighted[0][0]'] 
                                                                                                  
==================================================================================================
Total params: 106434 (415.76 KB)
Trainable params: 106434 (415.76 KB)
Non-trainable params: 0 (0.00 Byte)
__________________________________________________________________________________________________
Writing results to /home/user/projects/train/model/long_window/TCN_Residual/result/33
Curriculum: set focal gamma = 0.0000 (epoch 1)
Epoch 1/100
2025-09-16 18:22:19.299782: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:432] Loaded cuDNN version 8600
2025-09-16 18:22:19.552345: I tensorflow/tsl/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2025-09-16 18:22:19.847258: I tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:606] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
2025-09-16 18:22:19.921107: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7b15e0fc9200 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2025-09-16 18:22:19.921153: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 4070 SUPER, Compute Capability 8.9
2025-09-16 18:22:19.956000: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:255] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2025-09-16 18:22:20.114983: I tensorflow/tsl/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2025-09-16 18:22:20.171618: I ./tensorflow/compiler/jit/device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
14/14 - 6s - loss: 0.3456 - auc: 0.4691 - val_loss: 0.3278 - val_auc: 0.5104 - val_auc_custom: 0.5109 - val_f1_custom: 0.0667 - val_recall_custom: 0.0377 - 6s/epoch - 453ms/step
Curriculum: set focal gamma = 0.0789 (epoch 2)
Epoch 2/100
14/14 - 0s - loss: 0.2764 - auc: 0.5081 - val_loss: 0.2940 - val_auc: 0.5151 - val_auc_custom: 0.5152 - val_f1_custom: 0.0000e+00 - val_recall_custom: 0.0000e+00 - 276ms/epoch - 20ms/step
Curriculum: set focal gamma = 0.1579 (epoch 3)
Epoch 3/100
14/14 - 0s - loss: 0.2494 - auc: 0.5390 - val_loss: 0.2651 - val_auc: 0.5316 - val_auc_custom: 0.5326 - val_f1_custom: 0.0000e+00 - val_recall_custom: 0.0000e+00 - 288ms/epoch - 21ms/step
Curriculum: set focal gamma = 0.2368 (epoch 4)
Epoch 4/100
14/14 - -2s - loss: 0.2266 - auc: 0.5679 - val_loss: 0.2399 - val_auc: 0.5453 - val_auc_custom: 0.5469 - val_f1_custom: 0.0000e+00 - val_recall_custom: 0.0000e+00 - -2464187us/epoch - -176013us/step
Curriculum: set focal gamma = 0.3158 (epoch 5)
Epoch 5/100
14/14 - 0s - loss: 0.2066 - auc: 0.6175 - val_loss: 0.2212 - val_auc: 0.5660 - val_auc_custom: 0.5648 - val_f1_custom: 0.0000e+00 - val_recall_custom: 0.0000e+00 - 277ms/epoch - 20ms/step
Curriculum: set focal gamma = 0.3947 (epoch 6)
Epoch 6/100
14/14 - 0s - loss: 0.1913 - auc: 0.6472 - val_loss: 0.2080 - val_auc: 0.5794 - val_auc_custom: 0.5784 - val_f1_custom: 0.0727 - val_recall_custom: 0.0377 - 295ms/epoch - 21ms/step
Curriculum: set focal gamma = 0.4737 (epoch 7)
Epoch 7/100
14/14 - 0s - loss: 0.1777 - auc: 0.6755 - val_loss: 0.1981 - val_auc: 0.5891 - val_auc_custom: 0.5897 - val_f1_custom: 0.0702 - val_recall_custom: 0.0377 - 273ms/epoch - 20ms/step
Curriculum: set focal gamma = 0.5526 (epoch 8)
Epoch 8/100
14/14 - 0s - loss: 0.1646 - auc: 0.7016 - val_loss: 0.1897 - val_auc: 0.5901 - val_auc_custom: 0.5904 - val_f1_custom: 0.0678 - val_recall_custom: 0.0377 - 295ms/epoch - 21ms/step
Curriculum: set focal gamma = 0.6316 (epoch 9)
Epoch 9/100
14/14 - 0s - loss: 0.1544 - auc: 0.7177 - val_loss: 0.1817 - val_auc: 0.5946 - val_auc_custom: 0.5945 - val_f1_custom: 0.0678 - val_recall_custom: 0.0377 - 285ms/epoch - 20ms/step
Curriculum: set focal gamma = 0.7105 (epoch 10)
Epoch 10/100
14/14 - 0s - loss: 0.1455 - auc: 0.7113 - val_loss: 0.1759 - val_auc: 0.5874 - val_auc_custom: 0.5867 - val_f1_custom: 0.0984 - val_recall_custom: 0.0566 - 257ms/epoch - 18ms/step
Curriculum: set focal gamma = 0.7895 (epoch 11)
Epoch 11/100
14/14 - 0s - loss: 0.1327 - auc: 0.7553 - val_loss: 0.1706 - val_auc: 0.5888 - val_auc_custom: 0.5892 - val_f1_custom: 0.0984 - val_recall_custom: 0.0566 - 272ms/epoch - 19ms/step
Curriculum: set focal gamma = 0.8684 (epoch 12)
Epoch 12/100
14/14 - 0s - loss: 0.1259 - auc: 0.7564 - val_loss: 0.1612 - val_auc: 0.5957 - val_auc_custom: 0.5967 - val_f1_custom: 0.0984 - val_recall_custom: 0.0566 - 284ms/epoch - 20ms/step
Curriculum: set focal gamma = 0.9474 (epoch 13)
Epoch 13/100
14/14 - 0s - loss: 0.1160 - auc: 0.7743 - val_loss: 0.1544 - val_auc: 0.6064 - val_auc_custom: 0.6055 - val_f1_custom: 0.1290 - val_recall_custom: 0.0755 - 300ms/epoch - 21ms/step
Curriculum: set focal gamma = 1.0263 (epoch 14)
Epoch 14/100
14/14 - 0s - loss: 0.1094 - auc: 0.7798 - val_loss: 0.1524 - val_auc: 0.6042 - val_auc_custom: 0.6033 - val_f1_custom: 0.2222 - val_recall_custom: 0.1509 - 277ms/epoch - 20ms/step
Curriculum: set focal gamma = 1.1053 (epoch 15)
Epoch 15/100
14/14 - 0s - loss: 0.0999 - auc: 0.8009 - val_loss: 0.1454 - val_auc: 0.6127 - val_auc_custom: 0.6126 - val_f1_custom: 0.1791 - val_recall_custom: 0.1132 - 273ms/epoch - 19ms/step
Curriculum: set focal gamma = 1.1842 (epoch 16)
Epoch 16/100
14/14 - 0s - loss: 0.0934 - auc: 0.8134 - val_loss: 0.1418 - val_auc: 0.6143 - val_auc_custom: 0.6143 - val_f1_custom: 0.2432 - val_recall_custom: 0.1698 - 285ms/epoch - 20ms/step
Curriculum: set focal gamma = 1.2632 (epoch 17)
Epoch 17/100
14/14 - 0s - loss: 0.0861 - auc: 0.8213 - val_loss: 0.1364 - val_auc: 0.6152 - val_auc_custom: 0.6158 - val_f1_custom: 0.2857 - val_recall_custom: 0.2075 - 306ms/epoch - 22ms/step
Curriculum: set focal gamma = 1.3421 (epoch 18)
Epoch 18/100
14/14 - 0s - loss: 0.0778 - auc: 0.8442 - val_loss: 0.1337 - val_auc: 0.6147 - val_auc_custom: 0.6146 - val_f1_custom: 0.2857 - val_recall_custom: 0.2075 - 270ms/epoch - 19ms/step
Curriculum: set focal gamma = 1.4211 (epoch 19)
Epoch 19/100
14/14 - 0s - loss: 0.0742 - auc: 0.8456 - val_loss: 0.1260 - val_auc: 0.6179 - val_auc_custom: 0.6181 - val_f1_custom: 0.2785 - val_recall_custom: 0.2075 - 286ms/epoch - 20ms/step
Curriculum: set focal gamma = 1.5000 (epoch 20)
Epoch 20/100
14/14 - 0s - loss: 0.0685 - auc: 0.8555 - val_loss: 0.1223 - val_auc: 0.6164 - val_auc_custom: 0.6171 - val_f1_custom: 0.3038 - val_recall_custom: 0.2264 - 265ms/epoch - 19ms/step
Curriculum: set focal gamma = 1.5000 (epoch 21)
Epoch 21/100
14/14 - 0s - loss: 0.0668 - auc: 0.8653 - val_loss: 0.1188 - val_auc: 0.6209 - val_auc_custom: 0.6209 - val_f1_custom: 0.2667 - val_recall_custom: 0.1887 - 296ms/epoch - 21ms/step
Curriculum: set focal gamma = 1.5000 (epoch 22)
Epoch 22/100
14/14 - 0s - loss: 0.0648 - auc: 0.8746 - val_loss: 0.1205 - val_auc: 0.6200 - val_auc_custom: 0.6186 - val_f1_custom: 0.2632 - val_recall_custom: 0.1887 - 264ms/epoch - 19ms/step
Curriculum: set focal gamma = 1.5000 (epoch 23)
Epoch 23/100
14/14 - 0s - loss: 0.0659 - auc: 0.8734 - val_loss: 0.1224 - val_auc: 0.6204 - val_auc_custom: 0.6204 - val_f1_custom: 0.2597 - val_recall_custom: 0.1887 - 251ms/epoch - 18ms/step
Curriculum: set focal gamma = 1.5000 (epoch 24)
Epoch 24/100
14/14 - 0s - loss: 0.0635 - auc: 0.8827 - val_loss: 0.1226 - val_auc: 0.6219 - val_auc_custom: 0.6209 - val_f1_custom: 0.2597 - val_recall_custom: 0.1887 - 298ms/epoch - 21ms/step
Curriculum: set focal gamma = 1.5000 (epoch 25)
Epoch 25/100
14/14 - 0s - loss: 0.0615 - auc: 0.8909 - val_loss: 0.1250 - val_auc: 0.6189 - val_auc_custom: 0.6184 - val_f1_custom: 0.2821 - val_recall_custom: 0.2075 - 271ms/epoch - 19ms/step
Curriculum: set focal gamma = 1.5000 (epoch 26)
Epoch 26/100
14/14 - 0s - loss: 0.0605 - auc: 0.8979 - val_loss: 0.1258 - val_auc: 0.6162 - val_auc_custom: 0.6158 - val_f1_custom: 0.2821 - val_recall_custom: 0.2075 - 244ms/epoch - 17ms/step
Curriculum: set focal gamma = 1.5000 (epoch 27)
Epoch 27/100
14/14 - 0s - loss: 0.0592 - auc: 0.9018 - val_loss: 0.1288 - val_auc: 0.6164 - val_auc_custom: 0.6171 - val_f1_custom: 0.2857 - val_recall_custom: 0.2075 - 256ms/epoch - 18ms/step
Curriculum: set focal gamma = 1.5000 (epoch 28)
Epoch 28/100
14/14 - 0s - loss: 0.0566 - auc: 0.9134 - val_loss: 0.1312 - val_auc: 0.6122 - val_auc_custom: 0.6116 - val_f1_custom: 0.3373 - val_recall_custom: 0.2642 - 297ms/epoch - 21ms/step
Curriculum: set focal gamma = 1.5000 (epoch 29)
Epoch 29/100
14/14 - 0s - loss: 0.0554 - auc: 0.9165 - val_loss: 0.1391 - val_auc: 0.6138 - val_auc_custom: 0.6133 - val_f1_custom: 0.3571 - val_recall_custom: 0.2830 - 271ms/epoch - 19ms/step
Curriculum: set focal gamma = 1.5000 (epoch 30)
Epoch 30/100
14/14 - 0s - loss: 0.0541 - auc: 0.9176 - val_loss: 0.1350 - val_auc: 0.6130 - val_auc_custom: 0.6136 - val_f1_custom: 0.3000 - val_recall_custom: 0.2264 - 263ms/epoch - 19ms/step
Curriculum: set focal gamma = 1.5000 (epoch 31)
Epoch 31/100
14/14 - 0s - loss: 0.0517 - auc: 0.9323 - val_loss: 0.1421 - val_auc: 0.6121 - val_auc_custom: 0.6111 - val_f1_custom: 0.3571 - val_recall_custom: 0.2830 - 236ms/epoch - 17ms/step
Curriculum: set focal gamma = 1.5000 (epoch 32)
Epoch 32/100
14/14 - 0s - loss: 0.0499 - auc: 0.9380 - val_loss: 0.1416 - val_auc: 0.6138 - val_auc_custom: 0.6141 - val_f1_custom: 0.3038 - val_recall_custom: 0.2264 - 272ms/epoch - 19ms/step
Curriculum: set focal gamma = 1.5000 (epoch 33)
Epoch 33/100
14/14 - 0s - loss: 0.0512 - auc: 0.9289 - val_loss: 0.1442 - val_auc: 0.6053 - val_auc_custom: 0.6048 - val_f1_custom: 0.3571 - val_recall_custom: 0.2830 - 246ms/epoch - 18ms/step
Curriculum: set focal gamma = 1.5000 (epoch 34)
Epoch 34/100
14/14 - 0s - loss: 0.0494 - auc: 0.9382 - val_loss: 0.1452 - val_auc: 0.5999 - val_auc_custom: 0.6209 - val_f1_custom: 0.2597 - val_recall_custom: 0.1887 - 279ms/epoch - 20ms/step
Done. Results saved to /home/user/projects/train/model/long_window/TCN_Residual/result/33
