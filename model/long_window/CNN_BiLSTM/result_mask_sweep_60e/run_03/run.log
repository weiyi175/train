2025-09-16 22:44:11.957929: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-09-16 22:44:11.990717: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-09-16 22:44:12.466219: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-09-16 22:44:12.909210: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 22:44:12.931937: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 22:44:12.932083: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 22:44:12.934119: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 22:44:12.934219: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 22:44:12.934248: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 22:44:13.041520: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 22:44:13.041657: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 22:44:13.041666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1726] Could not identify NUMA node of platform GPU id 0, defaulting to 0.  Your kernel may not have been built with NUMA support.
2025-09-16 22:44:13.041692: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-09-16 22:44:13.041717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9517 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 SUPER, pci bus id: 0000:01:00.0, compute capability: 8.9
GPU detected: 1 physical, 1 logical -> ['/device:GPU:0']
Config: batch=16, accumulate_steps=8 -> effective_batch=128
Loaded (1276, 36, 75) (1276,)
Using mask channel "occlusion_flag" from long_raw (index 7)
Model: "cnn_bilstm_attn_masked"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 input (InputLayer)          [(None, 36, 75)]             0         []                            
                                                                                                  
 permute_time_features (Per  (None, 75, 36)               0         ['input[0][0]']               
 mute)                                                                                            
                                                                                                  
 conv0 (Conv1D)              (None, 75, 64)               6976      ['permute_time_features[0][0]'
                                                                    ]                             
                                                                                                  
 bn0 (BatchNormalization)    (None, 75, 64)               256       ['conv0[0][0]']               
                                                                                                  
 act0 (Activation)           (None, 75, 64)               0         ['bn0[0][0]']                 
                                                                                                  
 conv_dropout0 (Dropout)     (None, 75, 64)               0         ['act0[0][0]']                
                                                                                                  
 conv1 (Conv1D)              (None, 75, 64)               20544     ['conv_dropout0[0][0]']       
                                                                                                  
 bn1 (BatchNormalization)    (None, 75, 64)               256       ['conv1[0][0]']               
                                                                                                  
 act1 (Activation)           (None, 75, 64)               0         ['bn1[0][0]']                 
                                                                                                  
 conv_dropout1 (Dropout)     (None, 75, 64)               0         ['act1[0][0]']                
                                                                                                  
 conv2 (Conv1D)              (None, 75, 64)               12352     ['conv_dropout1[0][0]']       
                                                                                                  
 bn2 (BatchNormalization)    (None, 75, 64)               256       ['conv2[0][0]']               
                                                                                                  
 act2 (Activation)           (None, 75, 64)               0         ['bn2[0][0]']                 
                                                                                                  
 conv_dropout2 (Dropout)     (None, 75, 64)               0         ['act2[0][0]']                
                                                                                                  
 bilstm (Bidirectional)      (None, 75, 128)              66048     ['conv_dropout2[0][0]']       
                                                                                                  
 mlp_attn_u (Dense)          (None, 75, 32)               4128      ['bilstm[0][0]']              
                                                                                                  
 mlp_attn_score (Dense)      (None, 75, 1)                33        ['mlp_attn_u[0][0]']          
                                                                                                  
 mlp_attn_squeeze (Lambda)   (None, 75)                   0         ['mlp_attn_score[0][0]']      
                                                                                                  
 attn_mask (InputLayer)      [(None, 75)]                 0         []                            
                                                                                                  
 mlp_attn_apply_mask (Lambd  (None, 75)                   0         ['mlp_attn_squeeze[0][0]',    
 a)                                                                  'attn_mask[0][0]']           
                                                                                                  
 mlp_attn_softmax (Lambda)   (None, 75)                   0         ['mlp_attn_apply_mask[0][0]'] 
                                                                                                  
 mlp_attn_expand (Lambda)    (None, 75, 1)                0         ['mlp_attn_softmax[0][0]']    
                                                                                                  
 mlp_attn_weighted (Lambda)  (None, 128)                  0         ['bilstm[0][0]',              
                                                                     'mlp_attn_expand[0][0]']     
                                                                                                  
 fc1 (Dense)                 (None, 64)                   8256      ['mlp_attn_weighted[0][0]']   
                                                                                                  
 fc_dropout (Dropout)        (None, 64)                   0         ['fc1[0][0]']                 
                                                                                                  
 out (Dense)                 (None, 1)                    65        ['fc_dropout[0][0]']          
                                                                                                  
==================================================================================================
Total params: 119171 (465.51 KB)
Trainable params: 118786 (464.01 KB)
Non-trainable params: 385 (1.50 KB)
__________________________________________________________________________________________________
None
Writing results to /home/user/projects/train/model/long_window/CNN_BiLSTM/result_mask_sweep_60e/run_03/01
Curriculum: set focal gamma = 0.0000 (epoch 1)
Epoch 1/60
2025-09-16 22:44:18.335690: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:432] Loaded cuDNN version 8600
2025-09-16 22:44:18.455064: I tensorflow/tsl/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2025-09-16 22:44:18.625030: I tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:606] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
2025-09-16 22:44:19.007499: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x6264fc3c14d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2025-09-16 22:44:19.007560: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 4070 SUPER, Compute Capability 8.9
2025-09-16 22:44:19.012575: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:255] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2025-09-16 22:44:19.072862: I tensorflow/tsl/platform/default/subprocess.cc:304] Start cannot spawn child process: No such file or directory
2025-09-16 22:44:19.113056: I ./tensorflow/compiler/jit/device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
56/56 - 8s - loss: 0.3196 - auc: 0.5507 - val_loss: 0.3159 - val_auc: 0.6079 - val_auc_custom: 0.6111 - val_f1_custom: 0.0000e+00 - val_recall_custom: 0.0000e+00 - 8s/epoch - 141ms/step
Curriculum: set focal gamma = 0.0789 (epoch 2)
Epoch 2/60
56/56 - 1s - loss: 0.2545 - auc: 0.5555 - val_loss: 0.2571 - val_auc: 0.6213 - val_auc_custom: 0.6174 - val_f1_custom: 0.0000e+00 - val_recall_custom: 0.0000e+00 - 1s/epoch - 23ms/step
Curriculum: set focal gamma = 0.1579 (epoch 3)
Epoch 3/60
56/56 - 1s - loss: 0.2337 - auc: 0.5932 - val_loss: 0.2299 - val_auc: 0.6221 - val_auc_custom: 0.6242 - val_f1_custom: 0.0000e+00 - val_recall_custom: 0.0000e+00 - 1s/epoch - 25ms/step
Curriculum: set focal gamma = 0.2368 (epoch 4)
Epoch 4/60
56/56 - 1s - loss: 0.2229 - auc: 0.5961 - val_loss: 0.2167 - val_auc: 0.6270 - val_auc_custom: 0.6264 - val_f1_custom: 0.0000e+00 - val_recall_custom: 0.0000e+00 - 1s/epoch - 26ms/step
Curriculum: set focal gamma = 0.3158 (epoch 5)
Epoch 5/60
56/56 - 1s - loss: 0.2035 - auc: 0.6396 - val_loss: 0.2051 - val_auc: 0.6238 - val_auc_custom: 0.6204 - val_f1_custom: 0.0370 - val_recall_custom: 0.0189 - 1s/epoch - 21ms/step
Curriculum: set focal gamma = 0.3947 (epoch 6)
Epoch 6/60
56/56 - 1s - loss: 0.1917 - auc: 0.6431 - val_loss: 0.1945 - val_auc: 0.6194 - val_auc_custom: 0.6189 - val_f1_custom: 0.0370 - val_recall_custom: 0.0189 - 1s/epoch - 22ms/step
Curriculum: set focal gamma = 0.4737 (epoch 7)
Epoch 7/60
56/56 - 1s - loss: 0.1792 - auc: 0.6659 - val_loss: 0.1847 - val_auc: 0.6192 - val_auc_custom: 0.6191 - val_f1_custom: 0.1071 - val_recall_custom: 0.0566 - 1s/epoch - 22ms/step
Curriculum: set focal gamma = 0.5526 (epoch 8)
Epoch 8/60
56/56 - 1s - loss: 0.1704 - auc: 0.6584 - val_loss: 0.1749 - val_auc: 0.6172 - val_auc_custom: 0.6156 - val_f1_custom: 0.1071 - val_recall_custom: 0.0566 - 1s/epoch - 22ms/step
Curriculum: set focal gamma = 0.6316 (epoch 9)
Epoch 9/60
56/56 - 1s - loss: 0.1623 - auc: 0.6516 - val_loss: 0.1656 - val_auc: 0.6138 - val_auc_custom: 0.6126 - val_f1_custom: 0.1071 - val_recall_custom: 0.0566 - 1s/epoch - 21ms/step
Curriculum: set focal gamma = 0.7105 (epoch 10)
Epoch 10/60
56/56 - 1s - loss: 0.1512 - auc: 0.6766 - val_loss: 0.1570 - val_auc: 0.6174 - val_auc_custom: 0.6179 - val_f1_custom: 0.1071 - val_recall_custom: 0.0566 - 1s/epoch - 22ms/step
Curriculum: set focal gamma = 0.7895 (epoch 11)
Epoch 11/60
56/56 - 1s - loss: 0.1434 - auc: 0.6719 - val_loss: 0.1477 - val_auc: 0.6242 - val_auc_custom: 0.6249 - val_f1_custom: 0.1071 - val_recall_custom: 0.0566 - 1s/epoch - 22ms/step
Curriculum: set focal gamma = 0.8684 (epoch 12)
Epoch 12/60
56/56 - 1s - loss: 0.1346 - auc: 0.6833 - val_loss: 0.1395 - val_auc: 0.6307 - val_auc_custom: 0.6345 - val_f1_custom: 0.1404 - val_recall_custom: 0.0755 - 1s/epoch - 23ms/step
Curriculum: set focal gamma = 0.9474 (epoch 13)
Epoch 13/60
56/56 - -2s - loss: 0.1275 - auc: 0.6941 - val_loss: 0.1315 - val_auc: 0.6381 - val_auc_custom: 0.6385 - val_f1_custom: 0.1695 - val_recall_custom: 0.0943 - -1546096us/epoch - -27609us/step
Curriculum: set focal gamma = 1.0263 (epoch 14)
Epoch 14/60
56/56 - 1s - loss: 0.1185 - auc: 0.7107 - val_loss: 0.1243 - val_auc: 0.6538 - val_auc_custom: 0.6506 - val_f1_custom: 0.1695 - val_recall_custom: 0.0943 - 1s/epoch - 24ms/step
Curriculum: set focal gamma = 1.1053 (epoch 15)
Epoch 15/60
56/56 - 1s - loss: 0.1123 - auc: 0.7122 - val_loss: 0.1177 - val_auc: 0.6561 - val_auc_custom: 0.6579 - val_f1_custom: 0.1967 - val_recall_custom: 0.1132 - 1s/epoch - 23ms/step
Curriculum: set focal gamma = 1.1842 (epoch 16)
Epoch 16/60
56/56 - 1s - loss: 0.1055 - auc: 0.7214 - val_loss: 0.1113 - val_auc: 0.6609 - val_auc_custom: 0.6649 - val_f1_custom: 0.1935 - val_recall_custom: 0.1132 - 1s/epoch - 23ms/step
Curriculum: set focal gamma = 1.2632 (epoch 17)
Epoch 17/60
56/56 - 1s - loss: 0.0995 - auc: 0.7260 - val_loss: 0.1051 - val_auc: 0.6684 - val_auc_custom: 0.6697 - val_f1_custom: 0.1935 - val_recall_custom: 0.1132 - 1s/epoch - 23ms/step
Curriculum: set focal gamma = 1.3421 (epoch 18)
Epoch 18/60
56/56 - 1s - loss: 0.0936 - auc: 0.7377 - val_loss: 0.0987 - val_auc: 0.6806 - val_auc_custom: 0.6825 - val_f1_custom: 0.1935 - val_recall_custom: 0.1132 - 1s/epoch - 23ms/step
Curriculum: set focal gamma = 1.4211 (epoch 19)
Epoch 19/60
56/56 - 1s - loss: 0.0874 - auc: 0.7497 - val_loss: 0.0937 - val_auc: 0.6874 - val_auc_custom: 0.6881 - val_f1_custom: 0.1935 - val_recall_custom: 0.1132 - 1s/epoch - 25ms/step
Curriculum: set focal gamma = 1.5000 (epoch 20)
Epoch 20/60
56/56 - 1s - loss: 0.0835 - auc: 0.7469 - val_loss: 0.0887 - val_auc: 0.6911 - val_auc_custom: 0.6916 - val_f1_custom: 0.1935 - val_recall_custom: 0.1132 - 1s/epoch - 24ms/step
Curriculum: set focal gamma = 1.5000 (epoch 21)
Epoch 21/60
56/56 - 1s - loss: 0.0807 - auc: 0.7735 - val_loss: 0.0879 - val_auc: 0.7043 - val_auc_custom: 0.7044 - val_f1_custom: 0.1935 - val_recall_custom: 0.1132 - 1s/epoch - 24ms/step
Curriculum: set focal gamma = 1.5000 (epoch 22)
Epoch 22/60
56/56 - 1s - loss: 0.0796 - auc: 0.7849 - val_loss: 0.0895 - val_auc: 0.6956 - val_auc_custom: 0.6958 - val_f1_custom: 0.2941 - val_recall_custom: 0.1887 - 1s/epoch - 22ms/step
Curriculum: set focal gamma = 1.5000 (epoch 23)
Epoch 23/60
56/56 - 1s - loss: 0.0793 - auc: 0.7809 - val_loss: 0.0913 - val_auc: 0.7003 - val_auc_custom: 0.7006 - val_f1_custom: 0.3288 - val_recall_custom: 0.2264 - 1s/epoch - 21ms/step
Curriculum: set focal gamma = 1.5000 (epoch 24)
Epoch 24/60
56/56 - 1s - loss: 0.0787 - auc: 0.7842 - val_loss: 0.0899 - val_auc: 0.7145 - val_auc_custom: 0.7160 - val_f1_custom: 0.2154 - val_recall_custom: 0.1321 - 1s/epoch - 23ms/step
Curriculum: set focal gamma = 1.5000 (epoch 25)
Epoch 25/60
56/56 - 1s - loss: 0.0772 - auc: 0.7944 - val_loss: 0.0910 - val_auc: 0.7098 - val_auc_custom: 0.7104 - val_f1_custom: 0.2899 - val_recall_custom: 0.1887 - 1s/epoch - 22ms/step
Curriculum: set focal gamma = 1.5000 (epoch 26)
Epoch 26/60
56/56 - 1s - loss: 0.0777 - auc: 0.7956 - val_loss: 0.0894 - val_auc: 0.7233 - val_auc_custom: 0.7230 - val_f1_custom: 0.3143 - val_recall_custom: 0.2075 - 1s/epoch - 23ms/step
Curriculum: set focal gamma = 1.5000 (epoch 27)
Epoch 27/60
56/56 - 1s - loss: 0.0728 - auc: 0.8312 - val_loss: 0.0900 - val_auc: 0.7291 - val_auc_custom: 0.7288 - val_f1_custom: 0.3143 - val_recall_custom: 0.2075 - 1s/epoch - 24ms/step
Curriculum: set focal gamma = 1.5000 (epoch 28)
Epoch 28/60
56/56 - 1s - loss: 0.0737 - auc: 0.8154 - val_loss: 0.0928 - val_auc: 0.7175 - val_auc_custom: 0.7182 - val_f1_custom: 0.3947 - val_recall_custom: 0.2830 - 1s/epoch - 22ms/step
Curriculum: set focal gamma = 1.5000 (epoch 29)
Epoch 29/60
56/56 - 1s - loss: 0.0731 - auc: 0.8263 - val_loss: 0.0920 - val_auc: 0.7244 - val_auc_custom: 0.7238 - val_f1_custom: 0.3143 - val_recall_custom: 0.2075 - 1s/epoch - 22ms/step
Curriculum: set focal gamma = 1.5000 (epoch 30)
Epoch 30/60
56/56 - 1s - loss: 0.0760 - auc: 0.8071 - val_loss: 0.0910 - val_auc: 0.7377 - val_auc_custom: 0.7381 - val_f1_custom: 0.2857 - val_recall_custom: 0.1887 - 1s/epoch - 23ms/step
Curriculum: set focal gamma = 1.5000 (epoch 31)
Epoch 31/60
56/56 - 1s - loss: 0.0708 - auc: 0.8388 - val_loss: 0.0961 - val_auc: 0.7092 - val_auc_custom: 0.7074 - val_f1_custom: 0.3896 - val_recall_custom: 0.2830 - 1s/epoch - 22ms/step
Curriculum: set focal gamma = 1.5000 (epoch 32)
Epoch 32/60
56/56 - 1s - loss: 0.0708 - auc: 0.8399 - val_loss: 0.0942 - val_auc: 0.7203 - val_auc_custom: 0.7208 - val_f1_custom: 0.3733 - val_recall_custom: 0.2642 - 1s/epoch - 22ms/step
Curriculum: set focal gamma = 1.5000 (epoch 33)
Epoch 33/60
56/56 - 1s - loss: 0.0717 - auc: 0.8331 - val_loss: 0.0955 - val_auc: 0.7190 - val_auc_custom: 0.7187 - val_f1_custom: 0.4156 - val_recall_custom: 0.3019 - 1s/epoch - 22ms/step
Curriculum: set focal gamma = 1.5000 (epoch 34)
Epoch 34/60
56/56 - 1s - loss: 0.0690 - auc: 0.8486 - val_loss: 0.0970 - val_auc: 0.7142 - val_auc_custom: 0.7147 - val_f1_custom: 0.3684 - val_recall_custom: 0.2642 - 1s/epoch - 21ms/step
Curriculum: set focal gamma = 1.5000 (epoch 35)
Epoch 35/60
56/56 - 1s - loss: 0.0683 - auc: 0.8506 - val_loss: 0.0966 - val_auc: 0.7273 - val_auc_custom: 0.7278 - val_f1_custom: 0.3099 - val_recall_custom: 0.2075 - 1s/epoch - 20ms/step
Curriculum: set focal gamma = 1.5000 (epoch 36)
Epoch 36/60
56/56 - 1s - loss: 0.0687 - auc: 0.8498 - val_loss: 0.1047 - val_auc: 0.7074 - val_auc_custom: 0.7072 - val_f1_custom: 0.4762 - val_recall_custom: 0.3774 - 1s/epoch - 21ms/step
Curriculum: set focal gamma = 1.5000 (epoch 37)
Epoch 37/60
56/56 - 1s - loss: 0.0666 - auc: 0.8599 - val_loss: 0.1017 - val_auc: 0.7136 - val_auc_custom: 0.7140 - val_f1_custom: 0.4250 - val_recall_custom: 0.3208 - 1s/epoch - 20ms/step
Curriculum: set focal gamma = 1.5000 (epoch 38)
Epoch 38/60
56/56 - 1s - loss: 0.0655 - auc: 0.8661 - val_loss: 0.1041 - val_auc: 0.7122 - val_auc_custom: 0.7117 - val_f1_custom: 0.4578 - val_recall_custom: 0.3585 - 1s/epoch - 22ms/step
Curriculum: set focal gamma = 1.5000 (epoch 39)
Epoch 39/60
56/56 - -2s - loss: 0.0676 - auc: 0.8563 - val_loss: 0.1050 - val_auc: 0.7009 - val_auc_custom: 0.6999 - val_f1_custom: 0.4524 - val_recall_custom: 0.3585 - -1683595us/epoch - -30064us/step
Curriculum: set focal gamma = 1.5000 (epoch 40)
Epoch 40/60
56/56 - 1s - loss: 0.0666 - auc: 0.8586 - val_loss: 0.1055 - val_auc: 0.7078 - val_auc_custom: 0.7381 - val_f1_custom: 0.2857 - val_recall_custom: 0.1887 - 1s/epoch - 22ms/step
Mask config -> mode=soft, threshold=0.8, window_gate=None
Done. Results saved to /home/user/projects/train/model/long_window/CNN_BiLSTM/result_mask_sweep_60e/run_03/01
